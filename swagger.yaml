openapi: 3.0.0
info:
  title: Face Gram API
  description: API cho mạng xã hội Face Gram
  version: 1.0.0
servers:
  - url: http://localhost:5000
    description: Server cục bộ
paths:
  /api/auth/signup:
    post:
      summary: Đăng ký người dùng mới
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                username:
                  type: string
                  description: Tên người dùng
                email:
                  type: string
                  description: Địa chỉ email
                password:
                  type: string
                  description: Mật khẩu
                profileTag:
                  type: string
                  description: Thẻ hồ sơ
              required:
                - username
                - email
                - password
      responses:
        '200':
          description: Người dùng được đăng ký thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  token:
                    type: string
                    description: Token JWT
        '400':
          description: Người dùng đã tồn tại
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Người dùng đã tồn tại
        '500':
          description: Lỗi server
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Lỗi server
  /api/auth/login:
    post:
      summary: Đăng nhập người dùng
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  description: Địa chỉ email
                password:
                  type: string
                  description: Mật khẩu
              required:
                - email
                - password
      responses:
        '200':
          description: Đăng nhập thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  token:
                    type: string
                    description: Token JWT
        '400':
          description: Thông tin đăng nhập không hợp lệ
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Thông tin đăng nhập không hợp lệ
        '500':
          description: Lỗi server
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Lỗi server
  /api/users/{id}:
    get:
      summary: Lấy hồ sơ người dùng
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: ID của người dùng
      responses:
        '200':
          description: Hồ sơ người dùng
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                  username:
                    type: string
                  email:
                    type: string
                  profileTag:
                    type: string
                  bio:
                    type: string
                  profilePicture:
                    type: string
                  coverPicture:
                    type: string
                  createdAt:
                    type: string
                    format: date-time
                  updatedAt:
                    type: string
                    format: date-time
        '404':
          description: Người dùng không tồn tại
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Người dùng không tồn tại
        '500':
          description: Lỗi server
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Lỗi server
    put:
      summary: Cập nhật hồ sơ người dùng
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: ID của người dùng
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                bio:
                  type: string
                  description: Tiểu sử người dùng
                profilePicture:
                  type: string
                  format: binary
                  description: Ảnh đại diện
                coverPicture:
                  type: string
                  format: binary
                  description: Ảnh bìa
      responses:
        '200':
          description: Hồ sơ người dùng được cập nhật
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                  username:
                    type: string
                  email:
                    type: string
                  profileTag:
                    type: string
                  bio:
                    type: string
                  profilePicture:
                    type: string
                  coverPicture:
                    type: string
                  createdAt:
                    type: string
                    format: date-time
                  updatedAt:
                    type: string
                    format: date-time
        '401':
          description: Không có quyền truy cập
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Không có quyền truy cập
        '404':
          description: Người dùng không tồn tại
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Người dùng không tồn tại
        '500':
          description: Lỗi server
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Lỗi server
  /api/users/{id}/follow:
    post:
      summary: Theo dõi người dùng
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: ID của người dùng cần theo dõi
      responses:
        '200':
          description: Theo dõi thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  follow:
                    type: object
                    properties:
                      followerId:
                        type: integer
                      followingId:
                        type: integer
                  followed:
                    type: boolean
                    description: Trạng thái theo dõi
        '400':
          description: Đã theo dõi hoặc không thể tự theo dõi
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Đã theo dõi hoặc không thể tự theo dõi
        '401':
          description: Không có quyền truy cập
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Không có quyền truy cập
        '404':
          description: Người dùng không tồn tại
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Người dùng không tồn tại
        '500':
          description: Lỗi server
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Lỗi server
  /api/users/{id}/unfollow:
    post:
      summary: Bỏ theo dõi người dùng
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: ID của người dùng cần bỏ theo dõi
      responses:
        '200':
          description: Bỏ theo dõi thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Bỏ theo dõi thành công
        '401':
          description: Không có quyền truy cập
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Không có quyền truy cập
        '404':
          description: Quan hệ theo dõi không tồn tại
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Quan hệ theo dõi không tồn tại
        '500':
          description: Lỗi server
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Lỗi server
  /api/users/search:
    get:
      summary: Tìm kiếm người dùng theo thẻ
      parameters:
        - name: tag
          in: query
          required: true
          schema:
            type: string
          description: Thẻ hồ sơ để tìm kiếm
      responses:
        '200':
          description: Danh sách người dùng
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                    username:
                      type: string
                    profileTag:
                      type: string
                    profilePicture:
                      type: string
        '400':
          description: Thẻ tìm kiếm không hợp lệ
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Thẻ tìm kiếm không hợp lệ
        '500':
          description: Lỗi server
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Lỗi server
  /api/users/suggestions:
    get:
      summary: Lấy danh sách người dùng đề xuất
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Danh sách người dùng đề xuất
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                    username:
                      type: string
                    profileTag:
                      type: string
                    profilePicture:
                      type: string
        '401':
          description: Không có quyền truy cập
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Không có quyền truy cập
        '500':
          description: Lỗi server
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Lỗi server
  /api/users/{id}/following:
    get:
      summary: Lấy danh sách người dùng đang theo dõi
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: ID của người dùng
      responses:
        '200':
          description: Danh sách người dùng đang theo dõi
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                    username:
                      type: string
                    profilePicture:
                      type: string
                    profileTag:
                      type: string
        '404':
          description: Người dùng không tồn tại
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Người dùng không tồn tại
        '500':
          description: Lỗi server
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Lỗi server
  /api/users/{id}/followers:
    get:
      summary: Lấy danh sách người theo dõi
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: ID của người dùng
      responses:
        '200':
          description: Danh sách người theo dõi
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                    username:
                      type: string
                    profilePicture:
                      type: string
                    profileTag:
                      type: string
        '404':
          description: Người dùng không tồn tại
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Người dùng không tồn tại
        '500':
          description: Lỗi server
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Lỗi server
  /api/posts:
    post:
      summary: Tạo bài viết mới
      security:
        - bearerAuth: []
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                content:
                  type: string
                  description: Nội dung bài viết
                image:
                  type: string
                  format: binary
                  description: Ảnh bài viết
              required:
                - content
      responses:
        '201':
          description: Bài viết được tạo thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                  userId:
                    type: integer
                  content:
                    type: string
                  image:
                    type: string
                  likes:
                    type: integer
                  createdAt:
                    type: string
                    format: date-time
                  updatedAt:
                    type: string
                    format: date-time
        '400':
          description: Nội dung bài viết là bắt buộc
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Nội dung bài viết là bắt buộc
        '401':
          description: Không có quyền truy cập
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Không có quyền truy cập
        '500':
          description: Lỗi server
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Lỗi server
    get:
      summary: Lấy danh sách bài viết với phân trang
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            default: 1
          description: Số trang
        - name: limit
          in: query
          schema:
            type: integer
            default: 10
          description: Số bài viết mỗi trang
      responses:
        '200':
          description: Danh sách bài viết
          content:
            application/json:
              schema:
                type: object
                properties:
                  posts:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                        userId:
                          type: integer
                        content:
                          type: string
                        image:
                          type: string
                        likes:
                          type: integer
                        createdAt:
                          type: string
                          format: date-time
                        updatedAt:
                          type: string
                          format: date-time
                        User:
                          type: object
                          properties:
                            id:
                              type: integer
                            username:
                              type: string
                            profilePicture:
                              type: string
                            profileTag:
                              type: string
                  totalPages:
                    type: integer
                  currentPage:
                    type: integer
        '400':
          description: Dữ liệu đầu vào không hợp lệ
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Trang và giới hạn phải lớn hơn 0
        '500':
          description: Lỗi server
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Lỗi server
  /api/posts/{id}:
    delete:
      summary: Xóa bài viết
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: ID của bài viết
      responses:
        '200':
          description: Bài viết đã được xóa
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Bài viết đã được xóa
        '400':
          description: ID bài viết không hợp lệ
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: ID bài viết không hợp lệ
        '401':
          description: Không có quyền truy cập
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Không có quyền truy cập
        '403':
          description: Không có quyền xóa
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Không có quyền xóa
        '404':
          description: Bài viết không tồn tại
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Bài viết không tồn tại
        '500':
          description: Lỗi server
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Lỗi server
  /api/posts/{id}/like:
    post:
      summary: Thích hoặc bỏ thích bài viết
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: ID của bài viết
      responses:
        '200':
          description: Thích hoặc bỏ thích thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  likes:
                    type: integer
                    description: Số lượt thích hiện tại
                  liked:
                    type: boolean
                    description: Trạng thái thích
        '400':
          description: ID bài viết không hợp lệ
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: ID bài viết không hợp lệ
        '401':
          description: Không có quyền truy cập
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Không có quyền truy cập
        '404':
          description: Bài viết không tồn tại
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Bài viết không tồn tại
        '500':
          description: Lỗi server
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Lỗi server
  /api/posts/{id}/likes:
    get:
      summary: Lấy danh sách lượt thích của bài viết
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: ID của bài viết
        - name: page
          in: query
          schema:
            type: integer
            default: 1
          description: Số trang
        - name: limit
          in: query
          schema:
            type: integer
            default: 10
          description: Số lượt thích mỗi trang
      responses:
        '200':
          description: Danh sách lượt thích của bài viết
          content:
            application/json:
              schema:
                type: object
                properties:
                  likes:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                        userId:
                          type: integer
                        postId:
                          type: integer
                        createdAt:
                          type: string
                          format: date-time
                        username:
                          type: string
                        profilePicture:
                          type: string
                        profileTag:
                          type: string
                  totalPages:
                    type: integer
                  currentPage:
                    type: integer
        '400':
          description: ID bài viết không hợp lệ
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: ID bài viết không hợp lệ
        '404':
          description: Bài viết không tồn tại
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Bài viết không tồn tại
        '500':
          description: Lỗi server
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Lỗi server
  /api/posts/{id}/comments:
    get:
      summary: Lấy danh sách bình luận của bài viết
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: ID của bài viết
        - name: page
          in: query
          schema:
            type: integer
            default: 1
          description: Số trang
        - name: limit
          in: query
          schema:
            type: integer
            default: 10
          description: Số bình luận mỗi trang
      responses:
        '200':
          description: Danh sách bình luận của bài viết
          content:
            application/json:
              schema:
                type: object
                properties:
                  comments:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                        userId:
                          type: integer
                        postId:
                          type: integer
                        content:
                          type: string
                        createdAt:
                          type: string
                          format: date-time
                        likes:
                          type: integer
                        username:
                          type: string
                        profilePicture:
                          type: string
                        profileTag:
                          type: string
                  totalPages:
                    type: integer
                  currentPage:
                    type: integer
        '400':
          description: ID bài viết không hợp lệ
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: ID bài viết không hợp lệ
        '404':
          description: Bài viết không tồn tại
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Bài viết không tồn tại
        '500':
          description: Lỗi server
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Lỗi server
  /api/posts/{id}/comment:
    post:
      summary: Bình luận bài viết
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: ID của bài viết
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                content:
                  type: string
                  description: Nội dung bình luận
              required:
                - content
      responses:
        '201':
          description: Bình luận được tạo thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                    description: ID của bình luận
                  userId:
                    type: integer
                    description: ID của người bình luận
                  postId:
                    type: integer
                    description: ID của bài viết
                  content:
                    type: string
                    description: Nội dung bình luận
                  createdAt:
                    type: string
                    format: date-time
                    description: Thời gian tạo bình luận
                  likes:
                    type: integer
                    description: Số lượt thích của bình luận
                  username:
                    type: string
                    description: Tên người dùng của người bình luận
                  profilePicture:
                    type: string
                    description: URL ảnh đại diện của người bình luận
                  profileTag:
                    type: string
                    description: Thẻ hồ sơ của người bình luận
        '400':
          description: Dữ liệu đầu vào không hợp lệ
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Nội dung bình luận là bắt buộc
        '401':
          description: Không có quyền truy cập
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Không có quyền truy cập
        '404':
          description: Bài viết không tồn tại
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Bài viết không tồn tại
        '500':
          description: Lỗi server
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Lỗi server
  /api/posts/{id}/recommend:
    post:
      summary: Đề xuất bài viết
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: ID của bài viết
      responses:
        '200':
          description: Bài viết đã được đề xuất
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Bài viết đã được đề xuất
        '400':
          description: ID bài viết không hợp lệ
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: ID bài viết không hợp lệ
        '401':
          description: Không có quyền truy cập
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Không có quyền truy cập
        '404':
          description: Bài viết không tồn tại
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Bài viết không tồn tại
        '500':
          description: Lỗi server
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Lỗi server
  /api/notifications:
    get:
      summary: Lấy danh sách thông báo với phân trang
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            default: 1
          description: Số trang
        - name: limit
          in: query
          schema:
            type: integer
            default: 10
          description: Số thông báo mỗi trang
      responses:
        '200':
          description: Danh sách thông báo
          content:
            application/json:
              schema:
                type: object
                properties:
                  notifications:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: ID của thông báo
                        userId:
                          type: integer
                          description: ID của người nhận thông báo
                        type:
                          type: string
                          enum: [like, comment, recommend]
                          description: Loại thông báo
                        relatedUserId:
                          type: integer
                          description: ID của người tạo hành động
                        relatedPostId:
                          type: integer
                          description: ID của bài viết liên quan
                        isRead:
                          type: boolean
                          description: Trạng thái đã đọc
                        createdAt:
                          type: string
                          format: date-time
                          description: Thời gian tạo
                        updatedAt:
                          type: string
                          format: date-time
                          description: Thời gian cập nhật
                        RelatedUser:
                          type: object
                          properties:
                            id:
                              type: integer
                            username:
                              type: string
                            profilePicture:
                              type: string
                        relatedPost:
                          type: object
                          properties:
                            id:
                              type: integer
                            content:
                              type: string
                    totalPages:
                      type: integer
                      description: Tổng số trang
                    currentPage:
                      type: integer
                      description: Trang hiện tại
        '400':
          description: Dữ liệu đầu vào không hợp lệ
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Trang và giới hạn phải lớn hơn 0
        '401':
          description: Không có quyền truy cập
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Không có quyền truy cập
        '500':
          description: Lỗi server
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Lỗi server
                  error:
                    type: string
                    description: Chi tiết lỗi (chỉ trong môi trường phát triển)
  /api/notifications/{id}/read:
    put:
      summary: Đánh dấu thông báo là đã đọc
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: ID của thông báo
      responses:
        '200':
          description: Thông báo đã được đánh dấu là đã đọc
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Thông báo đã được đánh dấu là đã đọc
        '400':
          description: ID thông báo không hợp lệ
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: ID thông báo không hợp lệ
        '401':
          description: Không có quyền truy cập
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Không có quyền truy cập
        '403':
          description: Không có quyền truy cập thông báo này
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Không có quyền truy cập thông báo này
        '404':
          description: Thông báo không tồn tại
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Thông báo không tồn tại
        '500':
          description: Lỗi server
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Lỗi server
                  error:
                    type: string
                    description: Chi tiết lỗi (chỉ trong môi trường phát triển)
  /api/comments/{id}/like:
    post:
      summary: Thích hoặc bỏ thích bình luận
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: ID của bình luận
      responses:
        '200':
          description: Thích hoặc bỏ thích thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  likes:
                    type: integer
                    description: Số lượt thích hiện tại
                  liked:
                    type: boolean
                    description: Trạng thái thích
        '400':
          description: ID bình luận không hợp lệ
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: ID bình luận không hợp lệ
        '401':
          description: Không có quyền truy cập
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Không có quyền truy cập
        '404':
          description: Bình luận không tồn tại
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Bình luận không tồn tại
        '500':
          description: Lỗi server
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Lỗi server
  /api/messages:
    get:
      summary: Lấy danh sách tin nhắn trong cuộc trò chuyện
      security:
        - bearerAuth: []
      parameters:
        - name: recipientId
          in: query
          required: true
          schema:
            type: integer
          description: ID của người nhận
        - name: page
          in: query
          schema:
            type: integer
            default: 1
          description: Số trang
        - name: limit
          in: query
          schema:
            type: integer
            default: 20
          description: Số tin nhắn mỗi trang
      responses:
        '200':
          description: Danh sách tin nhắn
          content:
            application/json:
              schema:
                type: object
                properties:
                  messages:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                        conversation_id:
                          type: integer
                        sender_id:
                          type: integer
                        recipient_id:
                          type: integer
                        content:
                          type: string
                        isRead:
                          type: boolean
                        createdAt:
                          type: string
                          format: date-time
                        Sender:
                          type: object
                          properties:
                            id:
                              type: integer
                            username:
                              type: string
                            profilePicture:
                              type: string
                        Recipient:
                          type: object
                          properties:
                            id:
                              type: integer
                            username:
                              type: string
                            profilePicture:
                              type: string
                  totalPages:
                    type: integer
                  currentPage:
                    type: integer
        '400':
          description: Dữ liệu đầu vào không hợp lệ
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: recipientId là bắt buộc
        '401':
          description: Không có quyền truy cập
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Không có quyền truy cập
        '500':
          description: Lỗi server
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Lỗi server
    post:
      summary: Gửi tin nhắn mới
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                recipientId:
                  type: integer
                  description: ID của người nhận
                content:
                  type: string
                  description: Nội dung tin nhắn
              required:
                - recipientId
                - content
      responses:
        '201':
          description: Tin nhắn được gửi thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                  conversation_id:
                    type: integer
                  sender_id:
                    type: integer
                  recipient_id:
                    type: integer
                  content:
                    type: string
                  isRead:
                    type: boolean
                  createdAt:
                    type: string
                    format: date-time
        '400':
          description: Dữ liệu đầu vào không hợp lệ
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: recipientId và content là bắt buộc
        '401':
          description: Không có quyền truy cập
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Không có quyền truy cập
        '404':
          description: Người nhận không tồn tại
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Người nhận không tồn tại
        '500':
          description: Lỗi server
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Lỗi server
  /api/messages/conversations:
    get:
      summary: Lấy danh sách cuộc trò chuyện của người dùng
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Danh sách cuộc trò chuyện
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                    user:
                      type: object
                      properties:
                        id:
                          type: integer
                        username:
                          type: string
                        profilePicture:
                          type: string
                    lastMessage:
                      type: string
                      nullable: true
                    lastMessageTime:
                      type: string
                      format: date-time
        '401':
          description: Không có quyền truy cập
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Không có quyền truy cập
        '500':
          description: Lỗi server
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Lỗi server
  /api/admin/auth/admin-login:
    post:
      summary: Đăng nhập admin
      tags: [Admin]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                username:
                  type: string
                  example: admin
                password:
                  type: string
                  example: 123
              required:
                - username
                - password
      responses:
        '200':
          description: Đăng nhập admin thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  token:
                    type: string
                    example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
        '400':
          description: Thiếu username hoặc password
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Username và password là bắt buộc
        '401':
          description: Sai username hoặc password
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Sai username hoặc password
        '500':
          description: Lỗi server
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Lỗi server
  /api/admin/users:
    get:
      summary: Lấy danh sách tài khoản
      tags: [Admin]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Danh sách tài khoản
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/User'
        '401':
          description: Không có quyền truy cập
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Không có quyền truy cập, token không hợp lệ
        '500':
          description: Lỗi server
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Lỗi server
    post:
      summary: Thêm tài khoản mới
      tags: [Admin]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserCreate'
      responses:
        '201':
          description: Tài khoản được tạo thành công
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        '400':
          description: Thiếu trường bắt buộc hoặc email đã tồn tại
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Username, email và password là bắt buộc
        '401':
          description: Không có quyền truy cập
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Không có quyền truy cập, token không hợp lệ
        '500':
          description: Lỗi server
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Lỗi server
  /api/admin/users/{id}:
    put:
      summary: Sửa thông tin tài khoản
      tags: [Admin]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
          description: ID của tài khoản cần sửa
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserUpdate'
      responses:
        '200':
          description: Tài khoản được cập nhật thành công
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        '400':
          description: Email đã được sử dụng
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Email đã được sử dụng
        '401':
          description: Không có quyền truy cập
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Không có quyền truy cập, token không hợp lệ
        '404':
          description: Người dùng không tồn tại
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Người dùng không tồn tại
        '500':
          description: Lỗi server
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Lỗi server
    delete:
      summary: Xóa tài khoản
      tags: [Admin]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
          description: ID của tài khoản cần xóa
      responses:
        '200':
          description: Xóa tài khoản thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Xóa người dùng thành công
        '401':
          description: Không có quyền truy cập
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Không có quyền truy cập, token không hợp lệ
        '404':
          description: Người dùng không tồn tại
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Người dùng không tồn tại
        '500':
          description: Lỗi server
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string
                    example: Lỗi server

components:
  schemas:
    User:
      type: object
      properties:
        id:
          type: integer
          example: 1
        username:
          type: string
          example: khanh
        email:
          type: string
          example: ao1@gmail.com
        profileTag:
          type: string
          example: "@khanh"
        bio:
          type: string
          example: "Hello world"
        profilePicture:
          type: string
          example: "/uploads/profile.jpg"
        coverPicture:
          type: string
          example: "/uploads/cover.jpg"
        createdAt:
          type: string
          format: date-time
          example: "2025-05-31T19:18:51.568Z"
    UserCreate:
      type: object
      properties:
        username:
          type: string
          example: khanh
        email:
          type: string
          example: ao1@gmail.com
        password:
          type: string
          example: "123456"
        profileTag:
          type: string
          example: "@khanh"
        bio:
          type: string
          example: "Hello world"
        profilePicture:
          type: string
          example: "/uploads/profile.jpg"
        coverPicture:
          type: string
          example: "/uploads/cover.jpg"
      required:
        - username
        - email
        - password
    UserUpdate:
      type: object
      properties:
        username:
          type: string
          example: khanh
        email:
          type: string
          example: ao1@gmail.com
        password:
          type: string
          example: "123456"
        profileTag:
          type: string
          example: "@khanh"
        bio:
          type: string
          example: "Hello world"
        profilePicture:
          type: string
          example: "/uploads/profile.jpg"
        coverPicture:
          type: string
          example: "/uploads/cover.jpg"
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT